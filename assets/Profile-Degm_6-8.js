import{_ as M,p as S,r as p,J as z,g as G,a as m,e as t,B as o,b as e,w as a,j as x,C as V,D as U,t as y,z as J,F as L,q as R,u as h,E as d,o as f,K as j,k as u,L as w,M as q,N as K,O,P as Q,Q as C}from"./index-B2QBWZZT.js";const Z={class:"profile-container"},H={class:"profile-content"},W={class:"profile-card"},X={class:"card-body"},Y={class:"avatar-section"},$={class:"avatar-container"},ss=["src","alt"],ts={class:"avatar-info"},es={class:"form-group"},as={class:"input-wrapper"},is={key:1,class:"form-value"},ls={class:"input-hint"},ns={class:"form-group"},rs={class:"form-value-readonly"},os={class:"form-group"},ds={class:"form-value-readonly id-value"},us={class:"monospace"},cs={class:"button-group"},vs={class:"profile-card danger-zone"},fs={class:"card-body"},ps={class:"security-item"},ms={class:"security-item"},ys={class:"security-item danger"},gs={class:"profile-card danger-zone critical"},bs={class:"card-body"},_s={class:"danger-warning"},ks={class:"danger-action"},xs={__name:"Profile",setup(ws){const N=h(),l=S(),c=p(!1),g=p(!1),B=p(null),i=z({username:l.userName,avatar:l.userAvatar}),_=p(l.userId||"user-"+Math.random().toString(36).substr(2,9));G(()=>{i.username=l.userName,i.avatar=l.userAvatar});function k(){N.push("/change-avatar")}async function A(v){const s=v.target.files?.[0];if(s){if(s.size>5*1024*1024){d.error("文件大小不能超过 5MB");return}if(!["image/jpeg","image/png","image/gif"].includes(s.type)){d.error("仅支持 JPG、PNG、GIF 格式");return}try{const n=new FileReader;n.onload=r=>{i.avatar=r.target.result,d.success("头像已更新")},n.readAsDataURL(s)}catch{d.error("读取文件失败")}}}function I(){c.value=!0,i.username=l.userName}async function P(){if(!i.username.trim()){d.warning("用户名不能为空");return}g.value=!0;try{await new Promise(v=>setTimeout(v,800)),l.updateProfile({userName:i.username,userAvatar:i.avatar}),d.success("个人信息已保存"),c.value=!1}catch{d.error("保存失败，请重试")}finally{g.value=!1}}function T(){c.value=!1,i.username=l.userName,i.avatar=l.userAvatar}function D(){navigator.clipboard.writeText(_.value).then(()=>{d.success("用户 ID 已复制")})}async function E(){try{await C.confirm("确定要退出所有设备上的登录会话吗？您需要重新登录。","确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),d.success("已退出所有会话，请重新登录")}catch{}}async function F(){try{await C.confirm("此操作将永久删除您的账户和所有相关数据。请输入您的邮箱地址以确认此操作。","删除账户",{confirmButtonText:"删除",cancelButtonText:"取消",type:"error"}),d.success("账户已删除")}catch{}}return(v,s)=>{const n=x("el-icon"),r=x("el-button");return f(),m("div",Z,[s[29]||(s[29]=t("div",{class:"profile-header"},[t("h1",null,"账户设置"),t("p",{class:"header-subtitle"},"管理您的账户信息和个人偏好")],-1)),t("div",H,[t("div",W,[s[16]||(s[16]=t("div",{class:"card-header"},[t("h2",null,"基本信息"),t("span",{class:"section-label"},"Profile")],-1)),t("div",X,[t("div",Y,[t("div",$,[t("img",{src:o(l).userAvatar,alt:i.username,class:"profile-avatar"},null,8,ss),t("button",{class:"avatar-edit-btn",onClick:k,title:"修改头像"},[e(n,null,{default:a(()=>[e(o(j))]),_:1})]),t("input",{ref_key:"avatarInput",ref:B,type:"file",accept:"image/*",style:{display:"none"},onChange:A},null,544)]),t("div",ts,[s[3]||(s[3]=t("div",{class:"info-label"},"用户头像",-1)),s[4]||(s[4]=t("div",{class:"info-text"},"支持 JPG, PNG, GIF（最大 5MB）",-1)),e(r,{type:"text",size:"small",onClick:k,class:"change-avatar-link"},{default:a(()=>[e(n,null,{default:a(()=>[e(o(w))]),_:1}),s[2]||(s[2]=u(" 修改头像 ",-1))]),_:1})])]),s[14]||(s[14]=t("div",{class:"form-divider"},null,-1)),t("div",es,[s[5]||(s[5]=t("label",{class:"form-label"},"用户名",-1)),t("div",as,[c.value?V((f(),m("input",{key:0,"onUpdate:modelValue":s[0]||(s[0]=b=>i.username=b),type:"text",class:"form-input editing",placeholder:"输入用户名",maxlength:"32",onFocus:s[1]||(s[1]=b=>b.target.select())},null,544)),[[U,i.username]]):(f(),m("div",is,y(o(l).userName),1)),t("div",ls,y(i.username.length)+" / 32 ",1)])]),t("div",ns,[s[6]||(s[6]=t("label",{class:"form-label"},"邮箱地址",-1)),t("div",rs,[e(n,{class:"readonly-icon"},{default:a(()=>[e(o(q))]),_:1}),t("span",null,y(o(l).userEmail),1)]),s[7]||(s[7]=t("div",{class:"readonly-hint"},"邮箱地址不可修改，如需更换请联系管理员",-1))]),t("div",os,[s[9]||(s[9]=t("label",{class:"form-label"},"用户 ID",-1)),t("div",ds,[t("span",us,y(_.value),1),e(r,{type:"text",size:"small",onClick:D,class:"copy-btn"},{default:a(()=>[e(n,null,{default:a(()=>[e(o(K))]),_:1}),s[8]||(s[8]=u(" 复制 ",-1))]),_:1})]),s[10]||(s[10]=t("div",{class:"readonly-hint"},"唯一的用户标识符",-1))]),s[15]||(s[15]=t("div",{class:"form-divider"},null,-1)),t("div",cs,[c.value?(f(),m(L,{key:1},[e(r,{type:"primary",onClick:P,loading:g.value,class:"action-btn"},{default:a(()=>[e(n,null,{default:a(()=>[e(o(O))]),_:1}),s[12]||(s[12]=u(" 保存更改 ",-1))]),_:1},8,["loading"]),e(r,{onClick:T,class:"action-btn cancel"},{default:a(()=>[...s[13]||(s[13]=[u(" 取消 ",-1)])]),_:1})],64)):(f(),J(r,{key:0,type:"primary",onClick:I,class:"action-btn"},{default:a(()=>[e(n,null,{default:a(()=>[e(o(w))]),_:1}),s[11]||(s[11]=u(" 编辑信息 ",-1))]),_:1}))])])]),t("div",vs,[s[25]||(s[25]=t("div",{class:"card-header"},[t("h2",null,"账户安全"),t("span",{class:"section-label"},"Security")],-1)),t("div",fs,[t("div",ps,[s[18]||(s[18]=t("div",{class:"security-info"},[t("div",{class:"security-title"},"修改密码"),t("div",{class:"security-description"},"定期修改密码保护您的账户安全")],-1)),e(r,{type:"text",class:"action-link"},{default:a(()=>[...s[17]||(s[17]=[u("修改",-1)])]),_:1})]),s[23]||(s[23]=R('<div class="security-divider" data-v-eb5ffdbb></div><div class="security-item" data-v-eb5ffdbb><div class="security-info" data-v-eb5ffdbb><div class="security-title" data-v-eb5ffdbb>两步验证 (2FA)</div><div class="security-description" data-v-eb5ffdbb>启用双因素认证增强账户安全</div></div><div class="security-status disabled" data-v-eb5ffdbb>未启用</div></div><div class="security-divider" data-v-eb5ffdbb></div>',3)),t("div",ms,[s[20]||(s[20]=t("div",{class:"security-info"},[t("div",{class:"security-title"},"登录会话"),t("div",{class:"security-description"},"管理已登录的设备和会话")],-1)),e(r,{type:"text",class:"action-link"},{default:a(()=>[...s[19]||(s[19]=[u("查看",-1)])]),_:1})]),s[24]||(s[24]=t("div",{class:"security-divider"},null,-1)),t("div",ys,[s[22]||(s[22]=t("div",{class:"security-info"},[t("div",{class:"security-title"},"退出所有会话"),t("div",{class:"security-description"},"这将在所有设备上登出您的账户")],-1)),e(r,{type:"danger",text:"",onClick:E},{default:a(()=>[...s[21]||(s[21]=[u(" 退出所有 ",-1)])]),_:1})])])]),t("div",gs,[s[28]||(s[28]=t("div",{class:"card-header"},[t("h2",null,"删除账户"),t("span",{class:"section-label danger"},"Danger Zone")],-1)),t("div",bs,[t("div",_s,[e(n,{class:"warning-icon"},{default:a(()=>[e(o(Q))]),_:1}),s[26]||(s[26]=t("div",{class:"warning-text"},[t("div",{class:"warning-title"},"此操作不可恢复"),t("div",{class:"warning-description"}," 删除账户会永久删除您的所有数据，包括笔记、聊天记录和设置。请谨慎操作。 ")],-1))]),t("div",ks,[e(r,{type:"danger",onClick:F},{default:a(()=>[...s[27]||(s[27]=[u(" 删除我的账户 ",-1)])]),_:1})])])])])])}}},Ns=M(xs,[["__scopeId","data-v-eb5ffdbb"]]);export{Ns as default};
