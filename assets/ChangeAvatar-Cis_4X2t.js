import{_ as S,p as D,r as p,a as w,e,q as M,B as n,t as f,s as b,n as T,b as t,w as r,j as k,E as i,u as z,o as y,R as A,k as F,O as E,S as J,T as R}from"./index-B2QBWZZT.js";const V={class:"change-avatar-container"},$={class:"avatar-editor"},j={class:"avatar-preview-section"},U={class:"avatar-display-box"},q=["src","alt"],K={class:"avatar-info"},L={class:"info-item"},O={class:"info-value"},H={class:"info-item"},Q={class:"info-value"},W={class:"avatar-upload-section"},X={class:"upload-icon"},Y={key:0,class:"preview-section"},Z={class:"preview-box"},ss=["src"],es={class:"file-info"},as={class:"info-row"},ts={class:"value"},ls={class:"info-row"},ns={class:"value"},is={class:"info-row"},os={class:"value"},rs={class:"action-buttons"},ds={class:"preview-hint"},us={key:1,class:"empty-state"},vs={class:"empty-icon"},cs={__name:"ChangeAvatar",setup(ps){const G=z(),d=D(),_=p(null),g=p(!1),o=p(null),u=p(null),m=p(!1);function x(){_.value?.click()}function B(a){g.value=!1;const s=a.dataTransfer?.files;s?.length>0&&h(s[0])}function I(a){const s=a.target.files;s?.length>0&&h(s[0])}function h(a){if(a.size>5*1024*1024){i.error("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 5MB");return}if(!["image/jpeg","image/png","image/gif"].includes(a.type)){i.error("ä»…æ”¯æŒ JPGã€PNGã€GIF æ ¼å¼");return}const l=new FileReader;l.onload=v=>{const c=new Image;c.onload=()=>{u.value=a,o.value=v.target.result,i.success("å›¾ç‰‡å·²åŠ è½½ï¼Œé¢„è§ˆå¯ç”¨")},c.onerror=()=>{i.error("å›¾ç‰‡æ ¼å¼æ— æ•ˆæˆ–å·²æŸå")},c.src=v.target.result},l.readAsDataURL(a)}function N(a){if(!a)return"0 B";const s=a/1024;return s<1024?`${s.toFixed(2)} KB`:`${(s/1024).toFixed(2)} MB`}async function C(){if(!o.value){i.warning("è¯·å…ˆé€‰æ‹©å›¾ç‰‡");return}m.value=!0;try{d.updateAvatarInStore(o.value),i.success("å¤´åƒä¿å­˜æˆåŠŸ"),await new Promise(a=>setTimeout(a,800)),setTimeout(()=>{G.push("/profile")},200)}catch(a){i.error("ä¿å­˜å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•"),console.error("å¤´åƒä¿å­˜é”™è¯¯:",a)}finally{m.value=!1}}function P(){o.value=null,u.value=null,_.value&&(_.value.value="")}return(a,s)=>{const l=k("el-icon"),v=k("el-button");return y(),w("div",V,[s[14]||(s[14]=e("div",{class:"page-header"},[e("h1",null,"ä¿®æ”¹å¤´åƒ"),e("p",{class:"header-subtitle"},"æ›´æ¢æ‚¨çš„å¤´åƒï¼Œæ”¯æŒ JPGã€PNGã€GIF æ ¼å¼ï¼ˆæœ€å¤§ 5MBï¼‰")],-1)),e("div",$,[e("div",j,[s[4]||(s[4]=e("div",{class:"preview-header"},"å½“å‰å¤´åƒ",-1)),e("div",U,[e("img",{src:n(d).userAvatar,alt:n(d).userName,class:"user-avatar-large"},null,8,q)]),e("div",K,[e("div",L,[s[2]||(s[2]=e("span",{class:"info-label"},"ç”¨æˆ·å",-1)),e("span",O,f(n(d).userName),1)]),e("div",H,[s[3]||(s[3]=e("span",{class:"info-label"},"é‚®ç®±",-1)),e("span",Q,f(n(d).userEmail),1)])])]),e("div",W,[e("div",{class:T(["upload-area",{"is-dragging":g.value}]),onDragover:s[0]||(s[0]=b(c=>g.value=!0,["prevent"])),onDragleave:s[1]||(s[1]=c=>g.value=!1),onDrop:b(B,["prevent"])},[e("div",{class:"upload-content",onClick:x},[e("div",X,[t(l,null,{default:r(()=>[t(n(A))]),_:1})]),s[5]||(s[5]=e("div",{class:"upload-text"},[e("div",{class:"upload-title"},"ç‚¹å‡»æˆ–æ‹–æ‹½ä¸Šä¼ "),e("div",{class:"upload-hint"},"æ”¯æŒ JPGã€PNGã€GIFï¼ˆæœ€å¤§ 5MBï¼‰")],-1))]),e("input",{ref_key:"fileInput",ref:_,type:"file",accept:"image/jpeg,image/png,image/gif",style:{display:"none"},onChange:I},null,544)],34),o.value?(y(),w("div",Y,[s[12]||(s[12]=e("div",{class:"preview-header"},"é¢„è§ˆ",-1)),e("div",Z,[e("img",{src:o.value,alt:"preview",class:"preview-img"},null,8,ss)]),e("div",es,[e("div",as,[s[6]||(s[6]=e("span",{class:"label"},"æ–‡ä»¶å",-1)),e("span",ts,f(u.value?.name),1)]),e("div",ls,[s[7]||(s[7]=e("span",{class:"label"},"æ–‡ä»¶å¤§å°",-1)),e("span",ns,f(N(u.value?.size)),1)]),e("div",is,[s[8]||(s[8]=e("span",{class:"label"},"æ–‡ä»¶ç±»å‹",-1)),e("span",os,f(u.value?.type),1)])]),e("div",rs,[t(v,{type:"primary",onClick:C,loading:m.value,size:"large",class:"save-btn"},{default:r(()=>[t(l,null,{default:r(()=>[t(n(E))]),_:1}),s[9]||(s[9]=F(" ä¿å­˜å¤´åƒ ",-1))]),_:1},8,["loading"]),t(v,{onClick:P,size:"large",class:"cancel-btn"},{default:r(()=>[...s[10]||(s[10]=[F(" å–æ¶ˆ ",-1)])]),_:1})]),e("div",ds,[t(l,null,{default:r(()=>[t(n(J))]),_:1}),s[11]||(s[11]=e("span",null,"é¢„è§ˆæ•ˆæœä»…ä¾›å‚è€ƒï¼Œä¿å­˜åå°†æˆä¸ºæ‚¨çš„å¤´åƒ",-1))])])):(y(),w("div",us,[e("div",vs,[t(l,null,{default:r(()=>[t(n(R))]),_:1})]),s[13]||(s[13]=e("div",{class:"empty-text"},"ä¸Šä¼ å›¾ç‰‡åï¼Œæ­¤å¤„å°†æ˜¾ç¤ºé¢„è§ˆ",-1))]))])]),s[15]||(s[15]=M('<div class="tips-section" data-v-df39e719><h3 class="tips-title" data-v-df39e719>ğŸ’¡ æç¤º</h3><ul class="tips-list" data-v-df39e719><li data-v-df39e719><span class="tip-icon" data-v-df39e719>âœ“</span><span data-v-df39e719>å»ºè®®ä½¿ç”¨ 1:1 çš„æ­£æ–¹å½¢å›¾ç‰‡ï¼Œæ•ˆæœæœ€ä½³</span></li><li data-v-df39e719><span class="tip-icon" data-v-df39e719>âœ“</span><span data-v-df39e719>æœ€å¤§æ–‡ä»¶å¤§å°ä¸º 5MBï¼Œæ”¯æŒ JPGã€PNGã€GIF æ ¼å¼</span></li><li data-v-df39e719><span class="tip-icon" data-v-df39e719>âœ“</span><span data-v-df39e719>å¤´åƒä¿®æ”¹åï¼Œæ‰€æœ‰å·²ç™»å½•çš„è®¾å¤‡éƒ½å°†åŒæ­¥æ›´æ–°</span></li><li data-v-df39e719><span class="tip-icon" data-v-df39e719>âœ“</span><span data-v-df39e719>æ‚¨å¯ä»¥éšæ—¶è¿”å›æ­¤é¡µé¢ä¿®æ”¹å¤´åƒ</span></li></ul></div>',1))])}}},_s=S(cs,[["__scopeId","data-v-df39e719"]]);export{_s as default};
